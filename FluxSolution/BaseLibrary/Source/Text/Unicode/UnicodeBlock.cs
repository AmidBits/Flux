using System.Linq;

namespace Flux.Text
{
#pragma warning disable CA1028 // Enum Storage should be Int32
  /// <summary>Each value contains both the first and the last code points for the block name (high 32-bits = first, low 32-bits = last).</summary>
  public enum UnicodeBlock
    : long
  {
    BasicLatin = 0x000000000000007F,
    Latin1Supplement = 0x00000080000000FF,
    LatinExtendedA = 0x000001000000017F,
    LatinExtendedB = 0x000001800000024F,
    IPAExtensions = 0x00000250000002AF,
    SpacingModifierLetters = 0x000002B0000002FF,
    CombiningDiacriticalMarks = 0x000003000000036F,
    GreekandCoptic = 0x00000370000003FF,
    Cyrillic = 0x00000400000004FF,
    CyrillicSupplement = 0x000005000000052F,
    Armenian = 0x000005300000058F,
    Hebrew = 0x00000590000005FF,
    Arabic = 0x00000600000006FF,
    Syriac = 0x000007000000074F,
    ArabicSupplement = 0x000007500000077F,
    Thaana = 0x00000780000007BF,
    NKo = 0x000007C0000007FF,
    Samaritan = 0x000008000000083F,
    Mandaic = 0x000008400000085F,
    SyriacSupplement = 0x000008600000086F,
    ArabicExtendedA = 0x000008A0000008FF,
    Devanagari = 0x000009000000097F,
    Bengali = 0x00000980000009FF,
    Gurmukhi = 0x00000A0000000A7F,
    Gujarati = 0x00000A8000000AFF,
    Oriya = 0x00000B0000000B7F,
    Tamil = 0x00000B8000000BFF,
    Telugu = 0x00000C0000000C7F,
    Kannada = 0x00000C8000000CFF,
    Malayalam = 0x00000D0000000D7F,
    Sinhala = 0x00000D8000000DFF,
    Thai = 0x00000E0000000E7F,
    Lao = 0x00000E8000000EFF,
    Tibetan = 0x00000F0000000FFF,
    Myanmar = 0x000010000000109F,
    Georgian = 0x000010A0000010FF,
    HangulJamo = 0x00001100000011FF,
    Ethiopic = 0x000012000000137F,
    EthiopicSupplement = 0x000013800000139F,
    Cherokee = 0x000013A0000013FF,
    UnifiedCanadianAboriginalSyllabics = 0x000014000000167F,
    Ogham = 0x000016800000169F,
    Runic = 0x000016A0000016FF,
    Tagalog = 0x000017000000171F,
    Hanunoo = 0x000017200000173F,
    Buhid = 0x000017400000175F,
    Tagbanwa = 0x000017600000177F,
    Khmer = 0x00001780000017FF,
    Mongolian = 0x00001800000018AF,
    UnifiedCanadianAboriginalSyllabicsExtended = 0x000018B0000018FF,
    Limbu = 0x000019000000194F,
    TaiLe = 0x000019500000197F,
    NewTaiLue = 0x00001980000019DF,
    KhmerSymbols = 0x000019E0000019FF,
    Buginese = 0x00001A0000001A1F,
    TaiTham = 0x00001A2000001AAF,
    CombiningDiacriticalMarksExtended = 0x00001AB000001AFF,
    Balinese = 0x00001B0000001B7F,
    Sundanese = 0x00001B8000001BBF,
    Batak = 0x00001BC000001BFF,
    Lepcha = 0x00001C0000001C4F,
    OlChiki = 0x00001C5000001C7F,
    CyrillicExtendedC = 0x00001C8000001C8F,
    GeorgianExtended = 0x00001C9000001CBF,
    SundaneseSupplement = 0x00001CC000001CCF,
    VedicExtensions = 0x00001CD000001CFF,
    PhoneticExtensions = 0x00001D0000001D7F,
    PhoneticExtensionsSupplement = 0x00001D8000001DBF,
    CombiningDiacriticalMarksSupplement = 0x00001DC000001DFF,
    LatinExtendedAdditional = 0x00001E0000001EFF,
    GreekExtended = 0x00001F0000001FFF,
    GeneralPunctuation = 0x000020000000206F,
    SuperscriptsandSubscripts = 0x000020700000209F,
    CurrencySymbols = 0x000020A0000020CF,
    CombiningDiacriticalMarksforSymbols = 0x000020D0000020FF,
    LetterlikeSymbols = 0x000021000000214F,
    NumberForms = 0x000021500000218F,
    Arrows = 0x00002190000021FF,
    MathematicalOperators = 0x00002200000022FF,
    MiscellaneousTechnical = 0x00002300000023FF,
    ControlPictures = 0x000024000000243F,
    OpticalCharacterRecognition = 0x000024400000245F,
    EnclosedAlphanumerics = 0x00002460000024FF,
    BoxDrawing = 0x000025000000257F,
    BlockElements = 0x000025800000259F,
    GeometricShapes = 0x000025A0000025FF,
    MiscellaneousSymbols = 0x00002600000026FF,
    Dingbats = 0x00002700000027BF,
    MiscellaneousMathematicalSymbolsA = 0x000027C0000027EF,
    SupplementalArrowsA = 0x000027F0000027FF,
    BraillePatterns = 0x00002800000028FF,
    SupplementalArrowsB = 0x000029000000297F,
    MiscellaneousMathematicalSymbolsB = 0x00002980000029FF,
    SupplementalMathematicalOperators = 0x00002A0000002AFF,
    MiscellaneousSymbolsandArrows = 0x00002B0000002BFF,
    Glagolitic = 0x00002C0000002C5F,
    LatinExtendedC = 0x00002C6000002C7F,
    Coptic = 0x00002C8000002CFF,
    GeorgianSupplement = 0x00002D0000002D2F,
    Tifinagh = 0x00002D3000002D7F,
    EthiopicExtended = 0x00002D8000002DDF,
    CyrillicExtendedA = 0x00002DE000002DFF,
    SupplementalPunctuation = 0x00002E0000002E7F,
    CJKRadicalsSupplement = 0x00002E8000002EFF,
    KangxiRadicals = 0x00002F0000002FDF,
    IdeographicDescriptionCharacters = 0x00002FF000002FFF,
    CJKSymbolsandPunctuation = 0x000030000000303F,
    Hiragana = 0x000030400000309F,
    Katakana = 0x000030A0000030FF,
    Bopomofo = 0x000031000000312F,
    HangulCompatibilityJamo = 0x000031300000318F,
    Kanbun = 0x000031900000319F,
    BopomofoExtended = 0x000031A0000031BF,
    CJKStrokes = 0x000031C0000031EF,
    KatakanaPhoneticExtensions = 0x000031F0000031FF,
    EnclosedCJKLettersandMonths = 0x00003200000032FF,
    CJKCompatibility = 0x00003300000033FF,
    CJKUnifiedIdeographsExtensionA = 0x0000340000004DBF,
    YijingHexagramSymbols = 0x00004DC000004DFF,
    CJKUnifiedIdeographs = 0x00004E0000009FFF,
    YiSyllables = 0x0000A0000000A48F,
    YiRadicals = 0x0000A4900000A4CF,
    Lisu = 0x0000A4D00000A4FF,
    Vai = 0x0000A5000000A63F,
    CyrillicExtendedB = 0x0000A6400000A69F,
    Bamum = 0x0000A6A00000A6FF,
    ModifierToneLetters = 0x0000A7000000A71F,
    LatinExtendedD = 0x0000A7200000A7FF,
    SylotiNagri = 0x0000A8000000A82F,
    CommonIndicNumberForms = 0x0000A8300000A83F,
    Phagspa = 0x0000A8400000A87F,
    Saurashtra = 0x0000A8800000A8DF,
    DevanagariExtended = 0x0000A8E00000A8FF,
    KayahLi = 0x0000A9000000A92F,
    Rejang = 0x0000A9300000A95F,
    HangulJamoExtendedA = 0x0000A9600000A97F,
    Javanese = 0x0000A9800000A9DF,
    MyanmarExtendedB = 0x0000A9E00000A9FF,
    Cham = 0x0000AA000000AA5F,
    MyanmarExtendedA = 0x0000AA600000AA7F,
    TaiViet = 0x0000AA800000AADF,
    MeeteiMayekExtensions = 0x0000AAE00000AAFF,
    EthiopicExtendedA = 0x0000AB000000AB2F,
    LatinExtendedE = 0x0000AB300000AB6F,
    CherokeeSupplement = 0x0000AB700000ABBF,
    MeeteiMayek = 0x0000ABC00000ABFF,
    HangulSyllables = 0x0000AC000000D7AF,
    HangulJamoExtendedB = 0x0000D7B00000D7FF,
    HighSurrogates = 0x0000D8000000DB7F,
    HighPrivateUseSurrogates = 0x0000DB800000DBFF,
    LowSurrogates = 0x0000DC000000DFFF,
    PrivateUseArea = 0x0000E0000000F8FF,
    CJKCompatibilityIdeographs = 0x0000F9000000FAFF,
    AlphabeticPresentationForms = 0x0000FB000000FB4F,
    ArabicPresentationFormsA = 0x0000FB500000FDFF,
    VariationSelectors = 0x0000FE000000FE0F,
    VerticalForms = 0x0000FE100000FE1F,
    CombiningHalfMarks = 0x0000FE200000FE2F,
    CJKCompatibilityForms = 0x0000FE300000FE4F,
    SmallFormVariants = 0x0000FE500000FE6F,
    ArabicPresentationFormsB = 0x0000FE700000FEFF,
    HalfwidthandFullwidthForms = 0x0000FF000000FFEF,
    Specials = 0x0000FFF00000FFFF,
    LinearBSyllabary = 0x000100000001007F,
    LinearBIdeograms = 0x00010080000100FF,
    AegeanNumbers = 0x000101000001013F,
    AncientGreekNumbers = 0x000101400001018F,
    AncientSymbols = 0x00010190000101CF,
    PhaistosDisc = 0x000101D0000101FF,
    Lycian = 0x000102800001029F,
    Carian = 0x000102A0000102DF,
    CopticEpactNumbers = 0x000102E0000102FF,
    OldItalic = 0x000103000001032F,
    Gothic = 0x000103300001034F,
    OldPermic = 0x000103500001037F,
    Ugaritic = 0x000103800001039F,
    OldPersian = 0x000103A0000103DF,
    Deseret = 0x000104000001044F,
    Shavian = 0x000104500001047F,
    Osmanya = 0x00010480000104AF,
    Osage = 0x000104B0000104FF,
    Elbasan = 0x000105000001052F,
    CaucasianAlbanian = 0x000105300001056F,
    LinearA = 0x000106000001077F,
    CypriotSyllabary = 0x000108000001083F,
    ImperialAramaic = 0x000108400001085F,
    Palmyrene = 0x000108600001087F,
    Nabataean = 0x00010880000108AF,
    Hatran = 0x000108E0000108FF,
    Phoenician = 0x000109000001091F,
    Lydian = 0x000109200001093F,
    MeroiticHieroglyphs = 0x000109800001099F,
    MeroiticCursive = 0x000109A0000109FF,
    Kharoshthi = 0x00010A0000010A5F,
    OldSouthArabian = 0x00010A6000010A7F,
    OldNorthArabian = 0x00010A8000010A9F,
    Manichaean = 0x00010AC000010AFF,
    Avestan = 0x00010B0000010B3F,
    InscriptionalParthian = 0x00010B4000010B5F,
    InscriptionalPahlavi = 0x00010B6000010B7F,
    PsalterPahlavi = 0x00010B8000010BAF,
    OldTurkic = 0x00010C0000010C4F,
    OldHungarian = 0x00010C8000010CFF,
    HanifiRohingya = 0x00010D0000010D3F,
    RumiNumeralSymbols = 0x00010E6000010E7F,
    OldSogdian = 0x00010F0000010F2F,
    Sogdian = 0x00010F3000010F6F,
    Elymaic = 0x00010FE000010FFF,
    Brahmi = 0x000110000001107F,
    Kaithi = 0x00011080000110CF,
    SoraSompeng = 0x000110D0000110FF,
    Chakma = 0x000111000001114F,
    Mahajani = 0x000111500001117F,
    Sharada = 0x00011180000111DF,
    SinhalaArchaicNumbers = 0x000111E0000111FF,
    Khojki = 0x000112000001124F,
    Multani = 0x00011280000112AF,
    Khudawadi = 0x000112B0000112FF,
    Grantha = 0x000113000001137F,
    Newa = 0x000114000001147F,
    Tirhuta = 0x00011480000114DF,
    Siddham = 0x00011580000115FF,
    Modi = 0x000116000001165F,
    MongolianSupplement = 0x000116600001167F,
    Takri = 0x00011680000116CF,
    Ahom = 0x000117000001173F,
    Dogra = 0x000118000001184F,
    WarangCiti = 0x000118A0000118FF,
    Nandinagari = 0x000119A0000119FF,
    ZanabazarSquare = 0x00011A0000011A4F,
    Soyombo = 0x00011A5000011AAF,
    PauCinHau = 0x00011AC000011AFF,
    Bhaiksuki = 0x00011C0000011C6F,
    Marchen = 0x00011C7000011CBF,
    MasaramGondi = 0x00011D0000011D5F,
    GunjalaGondi = 0x00011D6000011DAF,
    Makasar = 0x00011EE000011EFF,
    TamilSupplement = 0x00011FC000011FFF,
    Cuneiform = 0x00012000000123FF,
    CuneiformNumbersandPunctuation = 0x000124000001247F,
    EarlyDynasticCuneiform = 0x000124800001254F,
    EgyptianHieroglyphs = 0x000130000001342F,
    EgyptianHieroglyphFormatControls = 0x000134300001343F,
    AnatolianHieroglyphs = 0x000144000001467F,
    BamumSupplement = 0x0001680000016A3F,
    Mro = 0x00016A4000016A6F,
    BassaVah = 0x00016AD000016AFF,
    PahawhHmong = 0x00016B0000016B8F,
    Medefaidrin = 0x00016E4000016E9F,
    Miao = 0x00016F0000016F9F,
    IdeographicSymbolsandPunctuation = 0x00016FE000016FFF,
    Tangut = 0x00017000000187FF,
    TangutComponents = 0x0001880000018AFF,
    KanaSupplement = 0x0001B0000001B0FF,
    KanaExtendedA = 0x0001B1000001B12F,
    SmallKanaExtension = 0x0001B1300001B16F,
    Nushu = 0x0001B1700001B2FF,
    Duployan = 0x0001BC000001BC9F,
    ShorthandFormatControls = 0x0001BCA00001BCAF,
    ByzantineMusicalSymbols = 0x0001D0000001D0FF,
    MusicalSymbols = 0x0001D1000001D1FF,
    AncientGreekMusicalNotation = 0x0001D2000001D24F,
    MayanNumerals = 0x0001D2E00001D2FF,
    TaiXuanJingSymbols = 0x0001D3000001D35F,
    CountingRodNumerals = 0x0001D3600001D37F,
    MathematicalAlphanumericSymbols = 0x0001D4000001D7FF,
    SuttonSignWriting = 0x0001D8000001DAAF,
    GlagoliticSupplement = 0x0001E0000001E02F,
    NyiakengPuachueHmong = 0x0001E1000001E14F,
    Wancho = 0x0001E2C00001E2FF,
    MendeKikakui = 0x0001E8000001E8DF,
    Adlam = 0x0001E9000001E95F,
    IndicSiyaqNumbers = 0x0001EC700001ECBF,
    OttomanSiyaqNumbers = 0x0001ED000001ED4F,
    ArabicMathematicalAlphabeticSymbols = 0x0001EE000001EEFF,
    MahjongTiles = 0x0001F0000001F02F,
    DominoTiles = 0x0001F0300001F09F,
    PlayingCards = 0x0001F0A00001F0FF,
    EnclosedAlphanumericSupplement = 0x0001F1000001F1FF,
    EnclosedIdeographicSupplement = 0x0001F2000001F2FF,
    MiscellaneousSymbolsandPictographs = 0x0001F3000001F5FF,
    Emoticons = 0x0001F6000001F64F,
    OrnamentalDingbats = 0x0001F6500001F67F,
    TransportandMapSymbols = 0x0001F6800001F6FF,
    AlchemicalSymbols = 0x0001F7000001F77F,
    GeometricShapesExtended = 0x0001F7800001F7FF,
    SupplementalArrowsC = 0x0001F8000001F8FF,
    SupplementalSymbolsandPictographs = 0x0001F9000001F9FF,
    ChessSymbols = 0x0001FA000001FA6F,
    SymbolsandPictographsExtendedA = 0x0001FA700001FAFF,
    CJKUnifiedIdeographsExtensionB = 0x000200000002A6DF,
    CJKUnifiedIdeographsExtensionC = 0x0002A7000002B73F,
    CJKUnifiedIdeographsExtensionD = 0x0002B7400002B81F,
    CJKUnifiedIdeographsExtensionE = 0x0002B8200002CEAF,
    CJKUnifiedIdeographsExtensionF = 0x0002CEB00002EBEF,
    CJKCompatibilityIdeographsSupplement = 0x0002F8000002FA1F,
    Tags = 0x000E0000000E007F,
    VariationSelectorsSupplement = 0x000E0100000E01EF,
    SupplementaryPrivateUseAreaA = 0x000F0000000FFFFF,
    SupplementaryPrivateUseAreaB = 0x001000000010FFFF
  }
#pragma warning restore CA1028 // Enum Storage should be Int32

  namespace Text
  {
    public static partial class UnicodeEx
    {
      /// <summary>Yields a sequence of Unicode blocks with their respective first and last code points.</summary>
      public static System.Collections.Generic.IReadOnlyList<(UnicodeBlock block, int firstCodePoint, int lastCodePoint)> GetBlockRanges
        => ((long[])System.Enum.GetValues(typeof(UnicodeBlock))).Select(v => ((UnicodeBlock)v, (int)(v >> 32 & 0x7FFFFFFF), (int)(v & 0x7FFFFFFF))).ToList();

      /// <summary>Returns the first UTF32 code point in the specified Unicode block.</summary>
      public static int GetCodePointFirst(UnicodeBlock block)
        => (int)((long)block >> 32 & 0x7FFFFFFF);
      /// <summary>Returns the last UTF32 code point in the specified Unicode block.</summary>
      public static int GetCodePointLast(UnicodeBlock block)
        => (int)((long)block & 0x7FFFFFFF);

      /// <summary>Returns the Unicode block associated with in the specified UTF32 code point.</summary>
      public static UnicodeBlock GetBlock(int utf32)
      {
        foreach (var (block, firstCodePoint, lastCodePoint) in GetBlockRanges)
          if (utf32 >= firstCodePoint && utf32 <= lastCodePoint)
            return block;

        throw new System.ArgumentOutOfRangeException(nameof(utf32));
      }
      /// <summary>Returns the Unicode block associated with in the specified Rune.</summary>
      public static UnicodeBlock GetBlock(System.Text.Rune rune)
        => GetBlock(rune.Value);
    }
  }
}
